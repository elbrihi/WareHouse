<?xml version="1.0" ?>

<container xmlns="http://symfony.com/schema/dic/services"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://symfony.com/schema/dic/services http://symfony.com/schema/dic/services/services-1.0.xsd">

    
    <services>

        <defaults autowire="true" autoconfigure="true" public="false" />

        <service id="ChickenWarehouse\UserBundle\Infrastructure\Persistence\Doctrine\Repository\AuthTokenRepository"
                 class="ChickenWarehouse\UserBundle\Infrastructure\Persistence\Doctrine\Repository\AuthTokenRepository" >
                 <tag name="doctrine.repository_service"/>
        </service>

        <service id="ChickenWarehouse\UserBundle\Infrastructure\Persistence\Doctrine\Repository\UserRepository"
                 class="ChickenWarehouse\UserBundle\Infrastructure\Persistence\Doctrine\Repository\UserRepository" >
                 <tag name="doctrine.repository_service"/>
        </service>

    
         <!-- Register the AuthTokenManager service -->
        <service id="ChickenWarehouse\UserBundle\Application\Security\Authenticator\ApiTokenAuthenticator" 
                class="ChickenWarehouse\UserBundle\Application\Security\Authenticator\ApiTokenAuthenticator" >
        </service>

        <service id="ChickenWarehouse\UserBundle\Application\Service\Manager\AuthTokenManager" 
            class="ChickenWarehouse\UserBundle\Application\Service\Manager\AuthTokenManager" />

        <!-- Alias the AuthTokenManagerInterface to the AuthTokenManager implementation -->
        <service id="ChickenWarehouse\UserBundle\Application\Service\Manager\AuthTokenManagerInterface"
                 alias="ChickenWarehouse\UserBundle\Application\Service\Manager\AuthTokenManager" />

        <service id="ChickenWarehouse\UserBundle\UI\Controller\PostUserAuthTokenController">
            <tag name="controller.service_arguments" />
             <argument type="service" 
             id="ChickenWarehouse\UserBundle\Application\Service\Manager\AuthTokenManagerInterface" />
        </service>


        <service id="ChickenWarehouse\UserBundle\UI\Controller\PostAddNewUserController">
            <tag name="controller.service_arguments" />

        </service>

                <!-- Register the UserRepository service -->
        <service id="ChickenWarehouse\UserBundle\Domain\Repository\UserRepository"
                 class="ChickenWarehouse\UserBundle\Domain\Repository\UserRepository">
            <tag name="doctrine.repository_service" />
            <argument type="service" id="doctrine" />
        </service>

        
    </services>
    
</container>